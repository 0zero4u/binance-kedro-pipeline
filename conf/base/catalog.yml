# 01_raw
book_raw:
  type: kedro_datasets.pandas.CSVDataset
  filepath: "data/01_raw/book_ticker.csv"
  load_args:
    names: ["update_id", "best_bid_price", "best_bid_qty", "best_ask_price", "best_ask_qty", "transaction_time", "event_time"]
    skiprows: 1 
    # --- START OF FIX ---
    # Added quotes to all dtype values to ensure they are treated as strings
    dtype:
      update_id: 'int64'
      best_bid_price: 'float64'
      best_bid_qty: 'float64'
      best_ask_price: 'float64'
      best_ask_qty: 'float64'
      transaction_time: 'int64'
      event_time: 'int64'
    # --- END OF FIX ---

trade_raw:
  type: kedro_datasets.pandas.CSVDataset
  filepath: "data/01_raw/trades.csv"
  load_args:
    names: ["id", "price", "qty", "quote_qty", "time", "is_buyer_maker"]
    skiprows: 1
    # --- START OF FIX ---
    # Added quotes to all dtype values to ensure they are treated as strings
    dtype:
      id: 'int64'
      price: 'float64'
      qty: 'float64'
      quote_qty: 'float64'
      time: 'int64'
      is_buyer_maker: 'bool'
    # --- END OF FIX ---

# 02_intermediate
merged_tick_data: {type: kedro_datasets.pandas.ParquetDataset, filepath: "data/02_intermediate/merged_tick_data.parquet"}
enriched_tick_data_unvalidated: {type: MemoryDataSet}
enriched_tick_data: {type: MemoryDataSet}
resampled_data_100ms: {type: MemoryDataSet}
resampled_data_3s: {type: MemoryDataSet}
resampled_data_15s: {type: MemoryDataSet}
resampled_data_1min: {type: MemoryDataSet}
resampled_data_3min: {type: MemoryDataSet}

features_data_100ms: {type: MemoryDataSet}
features_data_3s: {type: MemoryDataSet}
features_data_15s: {type: MemoryDataSet}
features_data_1min: {type: MemoryDataSet}
features_data_3min: {type: MemoryDataSet}

# 03_primary
features_data_unvalidated: {type: MemoryDataSet}
features_data: {type: kedro_datasets.pandas.ParquetDataset, filepath: "data/03_primary/features_data.parquet"}

# 05_model_input (LGBM)
labeled_data:
  type: kedro_datasets.pandas.ParquetDataset
  filepath: "data/05_model_input/labeled_data.parquet"
  layer: model_input

# 06_models (LGBM)
lgbm_model:
  type: kedro_datasets.pickle.PickleDataset
  filepath: "data/06_models/lgbm_price_movement_model.pkl"
  layer: models

# 07_reporting (LGBM & New Traceability Report)
lgbm_eval_results:
  type: kedro_datasets.json.JSONDataset
  filepath: "data/07_reporting/lgbm_evaluation.json"

unified_5min_traceability_report:
  type: kedro_datasets.pandas.CSVDataset
  filepath: "data/07_reporting/unified_5min_traceability_report.csv"
  layer: reporting

# ----------------------------------------------------------------
# Datasets for the ARF Pipeline
# ----------------------------------------------------------------
features_data_arf: {type: kedro_datasets.pandas.ParquetDataset, filepath: data/03_primary/features_data_arf.parquet}
labeled_data_arf: {type: kedro_datasets.pandas.ParquetDataset, filepath: data/05_model_input/labeled_data_arf.parquet}
scaled_data_arf: {type: kedro_datasets.pandas.ParquetDataset, filepath: data/05_model_input/scaled_data_arf.parquet}
robust_scaler: {type: kedro_datasets.pickle.PickleDataset, filepath: data/06_models/robust_scaler.pkl}
arf_training_results: {type: kedro_datasets.pickle.PickleDataset, filepath: data/06_models/arf_training_results.pkl}
arf_model: {type: kedro_datasets.pickle.PickleDataset, filepath: data/06_models/arf_price_movement_model.pkl, layer: models}
